<?xml version="1.0" encoding="UTF-8"?><Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" PolicyId="Policy-with-5-rules" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" Version="1">
  <Description>Policy-with-5-rules</Description>
<PolicyDefaults><XPathVersion>http://www.w3.org/TR/1999/Rec-xpath-19991116</XPathVersion></PolicyDefaults>
  <Target/>
  <Rule Effect="Permit" RuleId="Rule1">
    <Description>User should be able access his/her own stuff (Check subject-id is equal to resource-id)</Description>
    <Target/>
    <Condition>
      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
          <SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false" SubjectCategory="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"/>
        </Apply>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
          <ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
        </Apply>
      </Apply>
    </Condition>
  </Rule>
  <Rule Effect="Permit" RuleId="Rule2">
    <Description>Only user's company's client can access user's stuff (Check client's company is equal to user's company)</Description>
    <Target/>
    <Condition>
      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
          <SubjectAttributeDesignator AttributeId="companyId" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false" SubjectCategory="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"/>
        </Apply>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
          <ResourceAttributeDesignator AttributeId="resourceCompanyId" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
        </Apply>
      </Apply>
    </Condition>
  </Rule>
  <Rule Effect="Permit" RuleId="adbe1a29-40c2-43e6-9da6-ac47d35bf96b">
    <Description>Rackspace-Company-can-Add-User</Description>
    <Target/>
    <Condition>
      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
	<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-normalize-to-lower-case">
          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
            <SubjectAttributeDesignator AttributeId="companyId" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false" SubjectCategory="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"/>
          </Apply>
        </Apply>
        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">rcn-000-000-000</AttributeValue>
      </Apply>
    </Condition>
  </Rule>
  <Rule Effect="Permit" RuleId="0f667122-d9ce-40e4-99f9-17c10530e0a3">
    <Description>Only Admin can add a user</Description>
    <Target/>
    <Condition>
      <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-normalize-to-lower-case">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue>
          </Apply>
          <SubjectAttributeDesignator AttributeId="role" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false" SubjectCategory="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"/>
        </Apply>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-is-in">
          <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-normalize-to-lower-case">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
              <ResourceAttributeDesignator AttributeId="resourceCompanyId" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/>
            </Apply>
          </Apply>
          <SubjectAttributeDesignator AttributeId="role-for-company" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false" SubjectCategory="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"/>
        </Apply>
      </Apply>
    </Condition>
  </Rule>
</Policy>
