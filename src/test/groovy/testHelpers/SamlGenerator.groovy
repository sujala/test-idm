package testHelpers

import com.rackspace.idm.Constants
import com.rackspace.idm.SAMLConstants
import org.apache.commons.codec.binary.StringUtils
import org.apache.xml.security.utils.Base64
import org.bouncycastle.util.encoders.Base64Encoder
import testHelpers.saml.SamlFactory

/**
 * Simple demo helper class to generate signed saml assertions.
 */
class SamlGenerator {

    public static void main(String[] args) {

        decode64("")
//        decode64("PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIERlc3RpbmF0aW9uPSJodHRwczovL2Rldi5vbmUucmFja3NwYWNlLmNvbS9wbHVnaW5zL3NlcnZsZXQvc2FtbHNzbyIgSUQ9ImlkYk5nRVhvbTdzNktjYWFxdlVha2d0QnJxSllvIiBJc3N1ZUluc3RhbnQ9IjIwMTUtMDctMjRUMTk6NTQ6NTdaIiBWZXJzaW9uPSIyLjAiPjxzYW1sOklzc3Vlcj5odHRwczovL2Rldi1yYWNrZXJsb2dpbi5mZWRzc28ucmFja3NwYWNlLmNvbS9uaWRwL3NhbWwyL21ldGFkYXRhPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPGRzOlNpZ25lZEluZm8+CjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTEiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNpZGJOZ0VYb203czZLY2FhcXZVYWtndEJycUpZbyI+CjxkczpUcmFuc2Zvcm1zPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPgo8L2RzOlRyYW5zZm9ybXM+CjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIvPgo8ZHM6RGlnZXN0VmFsdWU+RjlucFU1S1IxNDJGRzIwMk5qMmkwUlJOQWZJPTwvZHM6RGlnZXN0VmFsdWU+CjwvZHM6UmVmZXJlbmNlPgo8L2RzOlNpZ25lZEluZm8+CjxkczpTaWduYXR1cmVWYWx1ZT4KaFZSOVU0SnNSMCtQcG55RUZYYkY5VWRmZmVwYkw4VFRnZmZDYjZmTEdFZERydUlSNlo4ODVFcGphanM3Y1J0aXlhTDF5bmpxUFc2YgpkbVdoaW4rKzF4b2pLNDVTbEhRdWVaMGNLT0JPWFhaV1oyWlJEVUlVVTlCWWlIK3dSLzBNVjYrbkdPalRxbTM0emxuWUF5aVdpYjFrCnhmOXA2VUxSL084MWFXUS9QbHBDUG5WbWFKOEtEVTVXV2dvdG50S05kZm9BRlpyYjI1MEZ5VitRTk12eXVCN3NxYjFjNi84Vy9rd0QKbjBneURVWkZIRUFSQTJyRWgvdmplcXNKOEJSSkMyWlR3bS83SlE5aG9HNzJ3Q2V6WHhiWkF4LzJ0V1cwRjNIcE5uc3diUU1ITkpKRQp6aDM4M2NpWW90SE1LWFhJYmd0R2NvM2YvenZobHFFeWJiRlFaUT09CjwvZHM6U2lnbmF0dXJlVmFsdWU+CjxkczpLZXlJbmZvPgo8ZHM6WDUwOURhdGE+CjxkczpYNTA5Q2VydGlmaWNhdGU+Ck1JSUV1akNDQTZLZ0F3SUJBZ0lRQ3pMNWtQVVZSWHhOWHFDSGRuUGJnVEFOQmdrcWhraUc5dzBCQVFzRkFEQkJNUXN3Q1FZRFZRUUcKRXdKVlV6RVZNQk1HQTFVRUNoTU1kR2hoZDNSbExDQkpibU11TVJzd0dRWURWUVFERXhKMGFHRjNkR1VnVTFOTUlFTkJJQzBnUnpJdwpIaGNOTVRVd016QXlNREF3TURBd1doY05NVGN3TlRNeE1qTTFPVFU1V2pCeE1Rc3dDUVlEVlFRR0V3SlZVekVPTUF3R0ExVUVDQk1GClZHVjRZWE14RkRBU0JnTlZCQWNVQzFOaGJpQkJiblJ2Ym1sdk1Sc3dHUVlEVlFRS0ZCSlNZV05yYzNCaFkyVWdWVk1zSUVsdVl5NHgKSHpBZEJnTlZCQU1VRmlvdVptVmtjM052TG5KaFkydHpjR0ZqWlM1amIyMHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBdwpnZ0VLQW9JQkFRQzg2WUpJMjhrVlA2djg3R0hjazlhV1pPaWZZeXdqdDlUK0gyWlpEUVQwRlRMUE1rVncyZlFJS1MyaURoSFUwS0ZhCmh2YWx0WjZnWXlycHpCc240MUZYL1NYbytxbFUzNjJ1aXdKZjdVdnhXSllsaytDWEV6ejBrbnFITDI3dXM2RW5kOWh4akYwajVYNUMKYUdBUWdqYnVRUGNxY3pHaUJ1NnVZVmtGWEtmNFFTeCtRSHZIWFZyUklvWmY0K0VKN2RMMjN1bUxvOVVHNkIxOVF1a0VtUUF3V0xaZAo3UFpGZGZUOEJBd2lobWVKWnRNQzRvNlJwamhUNEVrc2l6SytBa0hlWk5OVjk2SGhjRG43UU9TQ1pqbzhpZEg2SnJUWjdDWDVvNWFNCmZrSTJwZGJRRWxiN1JnRUM2bUx5WlJMWVc2akRPME1oaTF3VE1EZDkyZ2w5alJySEFnTUJBQUdqZ2dGOE1JSUJlREFoQmdOVkhSRUUKR2pBWWdoWXFMbVpsWkhOemJ5NXlZV05yYzNCaFkyVXVZMjl0TUFrR0ExVWRFd1FDTUFBd2NnWURWUjBnQkdzd2FUQm5CZ3BnaGtnQgpodmhGQVFjMk1Ga3dKZ1lJS3dZQkJRVUhBZ0VXR21oMGRIQnpPaTh2ZDNkM0xuUm9ZWGQwWlM1amIyMHZZM0J6TUM4R0NDc0dBUVVGCkJ3SUNNQ01NSVdoMGRIQnpPaTh2ZDNkM0xuUm9ZWGQwWlM1amIyMHZjbVZ3YjNOcGRHOXllVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXcKSHdZRFZSMGpCQmd3Rm9BVXdrOUlWL3pSVDVyQVhUaDlEZ1hiMlM2MVVtQXdLd1lEVlIwZkJDUXdJakFnb0I2Z0hJWWFhSFIwY0RvdgpMM1JxTG5ONWJXTmlMbU52YlM5MGFpNWpjbXd3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01GY0dDQ3NHCkFRVUZCd0VCQkVzd1NUQWZCZ2dyQmdFRkJRY3dBWVlUYUhSMGNEb3ZMM1JxTG5ONWJXTmtMbU52YlRBbUJnZ3JCZ0VGQlFjd0FvWWEKYUhSMGNEb3ZMM1JxTG5ONWJXTmlMbU52YlM5MGFpNWpjblF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUQ0WURZSjUrQ3gwVUthNApnYXlCZFhRc0hNd1R0enRrYXluRy9pNlZSNUd3YllVMDBNeWtDdGpMblZmWE1yemgyampKYWZvMlQyY2hFeER0Nk9rdVR0SnBwdmhZCjJ1bWxFTG9iU1cxT1RWK05XNUU5b0Y0dGdHbGlIdWhMclAyY0ZURHU0eDEzOU56MkVibVJEWkJ6SzFuNzUvdmVDWVZtdHU0L2FjYm8KbldEbGpGemxGeWlFek83SnpIWVlmL1hJNEp6UVNhZDE1OURNamZOZEtLc1M0QU5IUVFXc01mT3JTY3M5SkVaVGtzdGpZaU1LSklhWQpRaXQvYndWY2tYYXA4V2dmakJpMHUvck80aldzNkN6WVd6TkgzY0JORGRvZCtvZkJRZnZFNTNZUHBlOU9WR2xBVFRxRmZ3YVZZc1JYCjBsUk82UnJaOGI5ZUZPSmhPM2dsUXFrPQo8L2RzOlg1MDlDZXJ0aWZpY2F0ZT4KPC9kczpYNTA5RGF0YT4KPC9kczpLZXlJbmZvPgo8L2RzOlNpZ25hdHVyZT48c2FtbHA6U3RhdHVzPjxzYW1scDpTdGF0dXNDb2RlIFZhbHVlPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6c3RhdHVzOlN1Y2Nlc3MiLz48L3NhbWxwOlN0YXR1cz48c2FtbDpBc3NlcnRpb24gSUQ9Imlka1oySTVsbE43YjhpU1pCYTVYZk93Rm9iclk4IiBJc3N1ZUluc3RhbnQ9IjIwMTUtMDctMjRUMTk6NTQ6NTdaIiBWZXJzaW9uPSIyLjAiPjxzYW1sOklzc3Vlcj5odHRwczovL2Rldi1yYWNrZXJsb2dpbi5mZWRzc28ucmFja3NwYWNlLmNvbS9uaWRwL3NhbWwyL21ldGFkYXRhPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPGRzOlNpZ25lZEluZm8+CjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTEiLz4KPGRzOlJlZmVyZW5jZSBVUkk9IiNpZGtaMkk1bGxON2I4aVNaQmE1WGZPd0ZvYnJZOCI+CjxkczpUcmFuc2Zvcm1zPgo8ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KPGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPgo8L2RzOlRyYW5zZm9ybXM+CjxkczpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjc2hhMSIvPgo8ZHM6RGlnZXN0VmFsdWU+TVNhbzlRZWhpUzVCbkNKVkEwM2s5V0grYlFrPTwvZHM6RGlnZXN0VmFsdWU+CjwvZHM6UmVmZXJlbmNlPgo8L2RzOlNpZ25lZEluZm8+CjxkczpTaWduYXR1cmVWYWx1ZT4KUG1TTm1TUVQ1WnExQ3Q3RTlZM1BnQURZNk5rY3BJak1oRXlRb0ozMzFQTHE1RHZ0bkdmOU9Fa1doM0NUdVphRkFLbEV4dkpRc0dTawp3VElnNVdwRHVLLzlUZnBxdFN5TmxKRWtBM21ZTE14T0YyekZnMkxPaFNFNk1LYmhYbFVVU0hsWGpzUVBHQmhidElPekx5YTA3dldqClFya1JSMnZUQ2dwY05TdVBKQWltbzlsU2JUeDVkYUE1WHNEL2xzVHdYdkM0T2tOVWpNZUhENm43MkhXR3pyREV1UHVPbGxHbk9GVkgKSTNWclduSGlLWTFBdHVtajRQMmwxb2JFOVBXVmhoV1BtbzNXMW9iNHByRmN5UkEyOXVBU2FTVzBhbDJ3aEZHQ1dnZVJmQ0JRTm5OYQozTzNaeUthdVB6U0JJTDRFd1RjdDJqa3R2a2ppd09ONHdyZng0UT09CjwvZHM6U2lnbmF0dXJlVmFsdWU+CjxkczpLZXlJbmZvPgo8ZHM6WDUwOURhdGE+CjxkczpYNTA5Q2VydGlmaWNhdGU+Ck1JSUV1akNDQTZLZ0F3SUJBZ0lRQ3pMNWtQVVZSWHhOWHFDSGRuUGJnVEFOQmdrcWhraUc5dzBCQVFzRkFEQkJNUXN3Q1FZRFZRUUcKRXdKVlV6RVZNQk1HQTFVRUNoTU1kR2hoZDNSbExDQkpibU11TVJzd0dRWURWUVFERXhKMGFHRjNkR1VnVTFOTUlFTkJJQzBnUnpJdwpIaGNOTVRVd016QXlNREF3TURBd1doY05NVGN3TlRNeE1qTTFPVFU1V2pCeE1Rc3dDUVlEVlFRR0V3SlZVekVPTUF3R0ExVUVDQk1GClZHVjRZWE14RkRBU0JnTlZCQWNVQzFOaGJpQkJiblJ2Ym1sdk1Sc3dHUVlEVlFRS0ZCSlNZV05yYzNCaFkyVWdWVk1zSUVsdVl5NHgKSHpBZEJnTlZCQU1VRmlvdVptVmtjM052TG5KaFkydHpjR0ZqWlM1amIyMHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBdwpnZ0VLQW9JQkFRQzg2WUpJMjhrVlA2djg3R0hjazlhV1pPaWZZeXdqdDlUK0gyWlpEUVQwRlRMUE1rVncyZlFJS1MyaURoSFUwS0ZhCmh2YWx0WjZnWXlycHpCc240MUZYL1NYbytxbFUzNjJ1aXdKZjdVdnhXSllsaytDWEV6ejBrbnFITDI3dXM2RW5kOWh4akYwajVYNUMKYUdBUWdqYnVRUGNxY3pHaUJ1NnVZVmtGWEtmNFFTeCtRSHZIWFZyUklvWmY0K0VKN2RMMjN1bUxvOVVHNkIxOVF1a0VtUUF3V0xaZAo3UFpGZGZUOEJBd2lobWVKWnRNQzRvNlJwamhUNEVrc2l6SytBa0hlWk5OVjk2SGhjRG43UU9TQ1pqbzhpZEg2SnJUWjdDWDVvNWFNCmZrSTJwZGJRRWxiN1JnRUM2bUx5WlJMWVc2akRPME1oaTF3VE1EZDkyZ2w5alJySEFnTUJBQUdqZ2dGOE1JSUJlREFoQmdOVkhSRUUKR2pBWWdoWXFMbVpsWkhOemJ5NXlZV05yYzNCaFkyVXVZMjl0TUFrR0ExVWRFd1FDTUFBd2NnWURWUjBnQkdzd2FUQm5CZ3BnaGtnQgpodmhGQVFjMk1Ga3dKZ1lJS3dZQkJRVUhBZ0VXR21oMGRIQnpPaTh2ZDNkM0xuUm9ZWGQwWlM1amIyMHZZM0J6TUM4R0NDc0dBUVVGCkJ3SUNNQ01NSVdoMGRIQnpPaTh2ZDNkM0xuUm9ZWGQwWlM1amIyMHZjbVZ3YjNOcGRHOXllVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXcKSHdZRFZSMGpCQmd3Rm9BVXdrOUlWL3pSVDVyQVhUaDlEZ1hiMlM2MVVtQXdLd1lEVlIwZkJDUXdJakFnb0I2Z0hJWWFhSFIwY0RvdgpMM1JxTG5ONWJXTmlMbU52YlM5MGFpNWpjbXd3SFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01GY0dDQ3NHCkFRVUZCd0VCQkVzd1NUQWZCZ2dyQmdFRkJRY3dBWVlUYUhSMGNEb3ZMM1JxTG5ONWJXTmtMbU52YlRBbUJnZ3JCZ0VGQlFjd0FvWWEKYUhSMGNEb3ZMM1JxTG5ONWJXTmlMbU52YlM5MGFpNWpjblF3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUQ0WURZSjUrQ3gwVUthNApnYXlCZFhRc0hNd1R0enRrYXluRy9pNlZSNUd3YllVMDBNeWtDdGpMblZmWE1yemgyampKYWZvMlQyY2hFeER0Nk9rdVR0SnBwdmhZCjJ1bWxFTG9iU1cxT1RWK05XNUU5b0Y0dGdHbGlIdWhMclAyY0ZURHU0eDEzOU56MkVibVJEWkJ6SzFuNzUvdmVDWVZtdHU0L2FjYm8KbldEbGpGemxGeWlFek83SnpIWVlmL1hJNEp6UVNhZDE1OURNamZOZEtLc1M0QU5IUVFXc01mT3JTY3M5SkVaVGtzdGpZaU1LSklhWQpRaXQvYndWY2tYYXA4V2dmakJpMHUvck80aldzNkN6WVd6TkgzY0JORGRvZCtvZkJRZnZFNTNZUHBlOU9WR2xBVFRxRmZ3YVZZc1JYCjBsUk82UnJaOGI5ZUZPSmhPM2dsUXFrPQo8L2RzOlg1MDlDZXJ0aWZpY2F0ZT4KPC9kczpYNTA5RGF0YT4KPC9kczpLZXlJbmZvPgo8L2RzOlNpZ25hdHVyZT48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIiBOYW1lUXVhbGlmaWVyPSJodHRwczovL2Rldi1yYWNrZXJsb2dpbi5mZWRzc28ucmFja3NwYWNlLmNvbS9uaWRwL3NhbWwyL21ldGFkYXRhIiBTUE5hbWVRdWFsaWZpZXI9ImRldi5vbmUucmFja3NwYWNlLmNvbSI+bWFyYzcxNzY8L3NhbWw6TmFtZUlEPjxzYW1sOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48c2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uRGF0YSBOb3RPbk9yQWZ0ZXI9IjIwMTUtMDctMjVUMDU6NTQ6NTZaIiBSZWNpcGllbnQ9Imh0dHBzOi8vZGV2Lm9uZS5yYWNrc3BhY2UuY29tL3BsdWdpbnMvc2VydmxldC9zYW1sc3NvIi8+PC9zYW1sOlN1YmplY3RDb25maXJtYXRpb24+PC9zYW1sOlN1YmplY3Q+PHNhbWw6Q29uZGl0aW9ucyBOb3RCZWZvcmU9IjIwMTUtMDctMjRUMTk6NDk6NTdaIiBOb3RPbk9yQWZ0ZXI9IjIwMTUtMDctMjRUMTk6NTk6NTdaIj48c2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjxzYW1sOkF1ZGllbmNlPmRldi5vbmUucmFja3NwYWNlLmNvbTwvc2FtbDpBdWRpZW5jZT48L3NhbWw6QXVkaWVuY2VSZXN0cmljdGlvbj48L3NhbWw6Q29uZGl0aW9ucz48c2FtbDpBdXRoblN0YXRlbWVudCBBdXRobkluc3RhbnQ9IjIwMTUtMDctMjRUMTk6NTQ6NTZaIiBTZXNzaW9uSW5kZXg9Imlka1oySTVsbE43YjhpU1pCYTVYZk93Rm9iclk4Ij48c2FtbDpBdXRobkNvbnRleHQ+PHNhbWw6QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6VGltZVN5bmNUb2tlbjwvc2FtbDpBdXRobkNvbnRleHRDbGFzc1JlZj48c2FtbDpBdXRobkNvbnRleHREZWNsUmVmPnNlY3VyZS9yYWRpdXMvdXJpPC9zYW1sOkF1dGhuQ29udGV4dERlY2xSZWY+PC9zYW1sOkF1dGhuQ29udGV4dD48L3NhbWw6QXV0aG5TdGF0ZW1lbnQ+PHNhbWw6QXR0cmlidXRlU3RhdGVtZW50PjxzYW1sOkF0dHJpYnV0ZSB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIE5hbWU9Ik5hbWUgSUQiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dW5zcGVjaWZpZWQiPjxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciPm1hcmM3MTc2PC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PC9zYW1sOkF0dHJpYnV0ZVN0YXRlbWVudD48L3NhbWw6QXNzZXJ0aW9uPjwvc2FtbHA6UmVzcG9uc2U+")

        //local docker environment
//        generate(Constants.DEFAULT_IDP_URI, "983452", Constants.DEFAULT_IDP_PRIVATE_KEY, Constants.DEFAULT_IDP_PUBLIC_KEY, "testUser")
        generateRacker(Constants.RACKER_IDP_URI, Constants.DEFAULT_IDP_PRIVATE_KEY, Constants.DEFAULT_IDP_PUBLIC_KEY, Constants.RACKER_IMPERSONATE)

        //qe racker staging (https://passwordsafe.corp.rackspace.com/projects/1441/credentials/30674)
//        String qeRackerStagingIssuer = "http://identityqe.rackspace.com/racker";
//        String qeRackerStagingPubKey = "/etc/idm/config/saml_keys/qeidentityracker_staging_public.crt";
//        String qeRackerStagingPriKey = "/etc/idm/config/saml_keys/qeidentityracker_staging_private.pkcs8";
//        generate(qeRackerStagingIssuer, qeRackerStagingPriKey, qeRackerStagingPubKey, "robe4218")


    }

    private static void decode64(String coded) {
        print(new String(Base64.decode(coded)))
    }

    private static void generate(String issuer, String domain, String privateKeyPath, String publicKeyPath, String validUser) {
        def factory = new SamlFactory()

        print("VALID PWD AUTH", factory.generateSamlAssertionStringForFederatedUser(issuer, validUser, 30000, domain))

        print("LOGOUT REQUEST FOR VALID PWD AUTH", factory.generateLogoutRequestStringForFederatedUser(issuer, validUser, privateKeyPath, publicKeyPath))

        print("VALID TOKEN AUTH", factory.generateSamlAssertionStringForFederatedUser(issuer, validUser, 30000, domain))
        print("INVALID EXPIRATION DATE REQUEST", factory.generateSamlAssertionStringForFederatedUser(issuer, validUser, -10, domain))
    }

    private static void generateRacker(String issuer, String privateKeyPath, String publicKeyPath, String validUser) {
        def factory = new SamlFactory()

        String samlResponseStr = factory.generateSamlAssertionStringForFederatedRacker(issuer, validUser, 30000, SAMLConstants.PASSWORD_PROTECTED_AUTHCONTEXT_REF_CLASS, privateKeyPath, publicKeyPath)
        print("VALID PWD AUTH", samlResponseStr)
        print("VALID PWD AUTH (Base64)", Base64.encode(StringUtils.getBytesUtf8(samlResponseStr)));

        print("VALID TOKEN AUTH", factory.generateSamlAssertionStringForFederatedRacker(issuer, validUser, 30000, SAMLConstants.TIMESYNCTOKEN_PROTECTED_AUTHCONTEXT_REF_CLASS, privateKeyPath, publicKeyPath))
        print("NON-EXISTANT USER", factory.generateSamlAssertionStringForFederatedRacker(issuer, "iDoNotExist", 30000, SAMLConstants.TIMESYNCTOKEN_PROTECTED_AUTHCONTEXT_REF_CLASS, privateKeyPath, publicKeyPath))
        print("INVALID ISSUER", factory.generateSamlAssertionStringForFederatedRacker("http://i.do.not.exist", validUser, 30000, SAMLConstants.TIMESYNCTOKEN_PROTECTED_AUTHCONTEXT_REF_CLASS, privateKeyPath, publicKeyPath))
        print("INVALID EXPIRATION DATE REQUEST", factory.generateSamlAssertionStringForFederatedRacker(issuer, validUser, -10, SAMLConstants.TIMESYNCTOKEN_PROTECTED_AUTHCONTEXT_REF_CLASS, privateKeyPath, publicKeyPath))
    }

    private static void print(String header, String samlAssertion) {
        System.out.println()
        System.out.println(String.format("**************** START %s *******************", header))
        System.out.println(samlAssertion)
        System.out.println(String.format("**************** END %s *******************", header))
        System.out.println()
    }
}
